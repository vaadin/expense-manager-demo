<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymer/lib/mixins/gesture-event-listeners.html">
<link rel="import" href="../bower_components/vaadin-button/vaadin-button.html">
<link rel="import" href="../bower_components/app-layout/app-layout.html">
<link rel="import" href="expense-editor.html">
<link rel="import" href="info-dialog.html">
<link rel="import" href="content-panel.html">
<link rel="import" href="filters-toolbar.html">
<link rel="import" href="data/store.html">
<link rel="import" href="../bower_components/iron-media-query/iron-media-query.html">

<dom-module id="overview-page">
  <template>
    <style>
      :host {
        display: block;
      }

      app-header-layout {
        background-color: var(--primary-background-color);
      }

      app-header {
        background-color: hsl(214, 27%, 26%);
        --app-header-content: {
          padding: 0 24px;
        }
      }

      app-toolbar h1 {
        color: var(--light-primary-color);
        font-weight: 300;
        font-size: 24px;
      }

      .content[phone] {
        flex-direction: column;
      }

      .content {
        display: flex;
        flex: auto;
        height: 0.001px;
      }

      #filters-toolbar[phone] {
        width: auto;
        box-shadow: rgba(0, 0, 0, 0.2) 0px -10px 6px -10px inset;
      }

      #filters-toolbar {
        width: 300px;
        box-shadow: inset -4px 0 16px -9px rgba(0, 0, 0, 0.5);
      }

      @media (max-width: 1124px) {
        .content {
          padding-right: 0;
        }
      }

      #content-panel {
        flex: 1;
      }

      #sync {
        color: var(--light-primary-color);
        margin-left: 8px;
        animation: spin 0.8s linear infinite;
      }

      #sync[hidden] {
        display: none;
        animation: none;
      }

      @keyframes spin {
        100% {
          transform: rotate(-360deg);
        }
      }

      .logout-button,
      .about-button {
        font-size: 14px;
        color: var(--lumo-primary-contrast-color);
        text-transform: uppercase;
      }

      @media (max-width: 900px) {
        app-toolbar {
          --app-toolbar-content: {
            padding: 0 6px 0 16px;
          }
        }
        app-toolbar h1 {
          font-size: 20px;
        }
      }

    </style>

    <app-header-layout fullbleed theme="dark">
      <app-header slot="header" fixed condenses>
        <app-toolbar>
          <h1 main-title>Expense Manager</h1>
          <vaadin-button on-tap="_showInfoDialog" theme="tertiary" class="about-button">Info</vaadin-button>
          <vaadin-button on-tap="_logout" theme="tertiary" class="logout-button">Logout</vaadin-button>
        </app-toolbar>
      </app-header>

      <div class="content" phone$="[[_phone]]" tablet$="[[_tablet]]">
        <filters-toolbar phone="[[_phone]]" tablet="[[_tablet]]" id="filters-toolbar"></filters-toolbar>
        <content-panel phone="[[_phone]]" tablet="[[_tablet]]" id="content-panel"></content-panel>
      </div>
    </app-header-layout>

    <iron-media-query
      query="(max-width: 900px)"
      query-matches="{{_phone}}">
    </iron-media-query>

    <iron-media-query
      query="(max-width: 1124px)"
      query-matches="{{_tablet}}">
    </iron-media-query>

    <expense-editor></expense-editor>
    <info-dialog></info-dialog>
  </template>

  <script>
    (function() {
      class OverviewPageElement extends ExpenseManager.ReduxMixin(Polymer.GestureEventListeners(Polymer.Element)) {
        static get is() {
          return 'overview-page';
        }

        static get properties() {
          return {
            _phone: Boolean,

            _tablet: Boolean
          };
        }

        _showInfoDialog() {
          this.dispatch('showInfoDialog');
        }

        _logout() {
          this.dispatch('logout');
        }
      }

      customElements.define(OverviewPageElement.is, OverviewPageElement);

      /**
       * @namespace ExpenseManager
       */
      window.ExpenseManager = window.ExpenseManager || {};
      ExpenseManager.OverviewPageElement = OverviewPageElement;
    })();
  </script>
</dom-module>
