!function(n){function e(n){if(n!==o)throw TypeError("Invalid constructor")}function t(n,e,t){if(n!==o)throw TypeError("Invalid constructor");this._name=e,this._db=t}var o=Object.create(null),r="$SimpleDB$",i="store";n.indexedDB&&indexedDB.open&&(e.prototype={open:function(n){return new Promise(function(e,c){var a=indexedDB.open(r+n);a.onupgradeneeded=function(){var n=a.result;n.createObjectStore(i)},a.onsuccess=function(){var r=a.result;e(new t(o,n,r))},a.onerror=function(){c(a.error)}})},"delete":function(n){return new Promise(function(e,t){var o=indexedDB.deleteDatabase(r+n);o.onsuccess=function(){e(void 0)},o.onerror=function(){t(o.error)}})}},t.cmp=indexedDB.cmp,t.prototype={get name(){return this._name},get:function(n){var e=this;return new Promise(function(t,o){var r=e._db.transaction(i,"readwrite"),c=r.objectStore(i),a=c.get(n);r.oncomplete=function(){t(a.result)},r.onabort=function(){o(r.error)}})},set:function(n,e){var t=this;return new Promise(function(o,r){var c=t._db.transaction(i,"readwrite"),a=c.objectStore(i);a.put(e,n);c.oncomplete=function(){o(void 0)},c.onabort=function(){r(c.error)}})},"delete":function(n){var e=this;return new Promise(function(t,o){var r=e._db.transaction(i,"readwrite"),c=r.objectStore(i);c["delete"](n);r.oncomplete=function(){t(void 0)},r.onabort=function(){o(r.error)}})},clear:function(){var n=this;return new Promise(function(e,t){var o=n._db.transaction(i,"readwrite"),r=o.objectStore(i);r.clear();o.oncomplete=function(){e(void 0)},o.onabort=function(){t(o.error)}})},forEach:function(n,e){var t=this;return new Promise(function(o,r){e=e||{};var c=t._db.transaction(i,"readwrite"),a=c.objectStore(i),u=a.openCursor(e.range,"reverse"===e.direction?"prev":"next");u.onsuccess=function(){var e=u.result;if(e)try{var t=n(e.key,e.value);t||e["continue"]()}catch(o){c.abort()}},c.oncomplete=function(){o(void 0)},c.onabort=function(){r(c.error)}})},getMany:function(n){var e=this;return new Promise(function(t,o){var r=e._db.transaction(i,"readwrite"),c=r.objectStore(i),a=[];n.forEach(function(n){c.get(n).onsuccess(function(n){a.push(n)})}),r.oncomplete=function(){t(a)},r.onabort=function(){o(r.error)}})},setMany:function(n){var e=this;return new Promise(function(t,o){var r=e._db.transaction(i,"readwrite"),c=r.objectStore(i);n.forEach(function(n){c.put(n.value,n.key)}),r.oncomplete=function(){t(void 0)},r.onabort=function(){o(r.error)}})},deleteMany:function(n){var e=this;return new Promise(function(t,o){var r=e._db.transaction(i,"readwrite"),c=r.objectStore(i);n.forEach(function(n){c["delete"](n)}),r.oncomplete=function(){t(void 0)},r.onabort=function(){o(r.error)}})}},n.simpleDB=new e(o),n.SimpleDBKeyRange=IDBKeyRange)}(self);