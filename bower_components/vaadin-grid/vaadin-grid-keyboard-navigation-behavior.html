<html><head><link rel="import" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html">
<link rel="import" href="../iron-a11y-announcer/iron-a11y-announcer.html">

</head><body><dom-module id="vaadin-grid-navigation-themability-styles">
  <template>
    <style>:host(:focus){outline:none;}:host([navigating]:not([interacting])) [focused] > tr[focused] > [focused] ::content > .cell-content{box-shadow:inset 0 0 0 3px rgba(0, 0, 0, 0.3);@apply (--vaadin-grid-focused-cell);}</style>
  </template>
</dom-module>

<script>window.vaadin=window.vaadin||{},vaadin.elements=vaadin.elements||{},vaadin.elements.grid=vaadin.elements.grid||{},vaadin.elements.grid.KeyboardNavigationBehaviorImpl={hostAttributes:{tabindex:-1,role:"application"},keyBindings:{"ctrl+home":"_onCtrlHome","ctrl+end":"_onCtrlEnd",down:"_onArrowDown",end:"_onEnd",enter:"_onEnter",esc:"_onEscape",f2:"_onF2",home:"_onHome",left:"_onArrowLeft",pagedown:"_onPageDown",pageup:"_onPageUp",right:"_onArrowRight","shift+tab":"_onShiftTab",space:"_onSpace",tab:"_onTab",up:"_onArrowUp"},attached:function(){Polymer.IronA11yAnnouncer.requestAvailability()},_onEnd:function(t){this.$.scroller._onEnd(t)},_onEnter:function(t){this.$.scroller._onEnter(t)},_onEscape:function(t){this.$.scroller._onEscape(t)},_onF2:function(t){this.$.scroller._onF2(t)},_onTab:function(t){this.$.scroller._onTab(t)},_onShiftTab:function(t){this.$.scroller._onShiftTab(t)},_onArrowDown:function(t){this.$.scroller._onArrowDown(t)},_onArrowUp:function(t){this.$.scroller._onArrowUp(t)},_onArrowRight:function(t){this.$.scroller._onArrowRight(t)},_onArrowLeft:function(t){this.$.scroller._onArrowLeft(t)},_onHome:function(t){this.$.scroller._onHome(t)},_onCtrlHome:function(t){this.$.scroller._onCtrlHome(t)},_onCtrlEnd:function(t){this.$.scroller._onCtrlEnd(t)},_onPageDown:function(t){this.$.scroller._onPageDown(t)},_onPageUp:function(t){this.$.scroller._onPageUp(t)},_onSpace:function(t){this.$.scroller._onSpace(t)}},vaadin.elements.grid.KeyboardNavigationBehavior=[vaadin.elements.grid.KeyboardNavigationBehaviorImpl,Polymer.IronA11yKeysBehavior],vaadin.elements.grid.TableKeyboardBehavior={properties:{_virtualFocus:{type:Object,observer:"_virtualFocusChanged"},interacting:{type:Boolean,reflectToAttribute:!0,value:!1},navigating:{type:Boolean,reflectToAttribute:!0,value:!1}},listeners:{"cell-focus":"_onCellFocus","cell-content-focus":"_onCellContentFocus"},_isFooterVisible:function(){return this.$.footer._rows.filter(function(t){return!t.hidden}).length>0},_onFocusout:function(t){this.navigating=!1,this.interacting=!1},_onHeaderFocus:function(t){this.navigating=!0,this.interacting=!1,this.$.header._focusedCellIndex=this.$.header._focusedCellIndex||0,this.$.header._focusedRowIndex=this.$.header._focusedRowIndex||0,this._virtualFocus=this.$.header},_onBodyFocus:function(t){this.navigating=!0,this.interacting=!1,this.$.items._focusedCellIndex=this.$.items._focusedCellIndex||0,this.$.items._focusedRowIndex=this.$.items._focusedRowIndex||0,this._virtualFocus=this.$.items},_onFooterFocus:function(t){this._isFooterVisible()?(this.navigating=!0,this.interacting=!1,this.$.footer._focusedCellIndex=this.$.footer._focusedCellIndex||0,this.$.footer._focusedRowIndex=this.$.footer._focusedRowIndex||0,this._virtualFocus=this.$.footer):this._virtualFocus||this.$.bodyFocusTrap.focus()},_virtualFocusChanged:function(t,e){e&&(e.focused=!1),t&&(t.focused=!0,t===this.$.items&&this._ensureVirtualFocusInViewport())},_onTab:function(t){if(!this.interacting)if(this.navigating)switch(this._virtualFocus){case this.$.header:this.$.bodyFocusTrap.focus(),t.preventDefault();break;case this.$.items:this.$.footerFocusTrap.focus(),this._isFooterVisible()?(this._virtualFocus=this.$.footer,t.preventDefault()):this._virtualFocus=null;break;case this.$.footer:this._virtualFocus=null}else{switch(this._virtualFocus){case this.$.header:this.$.headerFocusTrap.focus();break;case this.$.items:this.$.bodyFocusTrap.focus();break;case this.$.footer:this.$.footerFocusTrap.focus()}t.preventDefault()}},_onShiftTab:function(t){if(!this.interacting)if(this.navigating)switch(this._virtualFocus){case this.$.footer:this.$.bodyFocusTrap.focus(),t.preventDefault();break;case this.$.items:this.$.headerFocusTrap.focus(),t.preventDefault();break;case this.$.header:this.$.headerFocusTrap.focus(),this._virtualFocus=null}else{switch(this._virtualFocus){case this.$.footer:this.$.footerFocusTrap.focus();break;case this.$.items:this.$.bodyFocusTrap.focus();break;case this.$.header:this.$.headerFocusTrap.focus()}t.preventDefault()}},_isAboveViewport:function(t){return this.firstVisibleIndex>t},_onArrowDown:function(t){this.interacting||(t.preventDefault(),this.navigating=!0,this._virtualFocus.focusDown(),this._ensureVirtualFocusInViewport())},_scrollPageDown:function(){var t=this.$.header.getBoundingClientRect(),e=this.$.footer.getBoundingClientRect();this.$.table.scrollTop+=e.top-t.bottom,this._scrollHandler()},_onPageDown:function(t){if(!this.interacting)if(t.preventDefault(),this.navigating=!0,this._virtualFocus===this.$.items){var e=this.lastVisibleIndex;this._scrollPageDown(),this._virtualFocus._focusedRowIndex+=this.lastVisibleIndex-e||this.lastVisibleIndex-this._virtualFocus._focusedRowIndex,this._ensureVirtualFocusInViewport()}else this._virtualFocus.focusPageDown()},_scrollPageUp:function(){var t=this.$.header.getBoundingClientRect(),e=this.$.footer.getBoundingClientRect();this.$.table.scrollTop-=e.top-t.bottom,this._scrollHandler()},_onPageUp:function(t){if(!this.interacting)if(t.preventDefault(),this.navigating=!0,this._virtualFocus===this.$.items){var e=this.lastVisibleIndex;this._scrollPageUp(),this._virtualFocus._focusedRowIndex-=e-this.lastVisibleIndex||this._virtualFocus._focusedRowIndex,this._ensureVirtualFocusInViewport()}else this._virtualFocus.focusPageUp()},_onArrowUp:function(t){this.interacting||(t.preventDefault(),this.navigating=!0,this._virtualFocus.focusUp(),this._ensureVirtualFocusInViewport())},_onArrowRight:function(t){this.interacting||(t.preventDefault(),this.navigating=!0,this._virtualFocus.focusRight(),this._ensureVirtualFocusInViewport())},_onArrowLeft:function(t){this.interacting||(t.preventDefault(),this.navigating=!0,this._virtualFocus.focusLeft(),this._ensureVirtualFocusInViewport())},_onHome:function(t){this.interacting||(t.preventDefault(),this.navigating=!0,this._virtualFocus.focusHome(),this._ensureVirtualFocusInViewport())},_onEnd:function(t){this.interacting||(t.preventDefault(),this.navigating=!0,this._virtualFocus.focusEnd(),this._ensureVirtualFocusInViewport())},_moveFocusToFocusTarget:function(){var t=this._virtualFocus._focusedCell._cellContent,e=t.querySelector("[focus-target]")||t.firstElementChild;e&&e.focus()},_onEnter:function(t){this.interacting?"input"===t.detail.keyboardEvent.target.localName&&"text"===t.detail.keyboardEvent.target.type&&(this.interacting=!1,this._onTab(t)):(t.preventDefault(),this._moveFocusToFocusTarget())},_onEscape:function(t){this.interacting?(this.interacting=!1,this._onTab(t)):this.navigating&&this.domHost.focus()},_onF2:function(t){t.preventDefault(),this.interacting?(this.interacting=!1,this._onTab(t)):this._moveFocusToFocusTarget()},_onCtrlHome:function(t){this.interacting||(t.preventDefault(),this.navigating=!0,this._virtualFocus.focusFirst(),this._ensureVirtualFocusInViewport())},_onCtrlEnd:function(t){this.interacting||(t.preventDefault(),this.navigating=!0,this._virtualFocus.focusLast(),this._ensureVirtualFocusInViewport())},_onSpace:function(t){this.navigating&&!this.interacting&&this._virtualFocus===this.$.items&&(t.preventDefault(),this.fire("cell-activate",{model:this._virtualFocus._focusedCell.instance}))},_onCellContentFocus:function(t){this.interacting=!0,this._onCellFocus(t)},_onCellFocus:function(t){var e=t.detail.cell,i=e.parentElement,o=i.parentElement,n=Polymer.dom(o).children.indexOf(i);o===this.$.items&&(n=i.index),o._focusedRowIndex=n,o._focusedCellIndex=Polymer.dom(i).children.indexOf(e),this._virtualFocus=o,e.hasAttribute("detailscell")&&(o._focusedCellIndex=0,o._moveFocusToDetailsCell())},_ensureVirtualFocusInViewport:function(){var t=this._vidxOffset+this._virtualStart,e=this._virtualFocus._focusedRowIndex;this._virtualFocus===this.$.items&&(e<t||e>t+this._physicalCount)?(this.scrollToScaledIndex(e),this._virtualFocus._focusedCellChanged(e,this._virtualFocus._focusedCellIndex)):this._ensureElementInViewport(this._virtualFocus._focusedCell)},_ensureElementInViewport:function(t){var e=t.getBoundingClientRect();if(this._virtualFocus===this.$.items){var i=this.$.footer.getBoundingClientRect().top,o=this.$.header.getBoundingClientRect().bottom;e.bottom>i?this.$.table.scrollTop+=e.bottom-i:e.top<o&&(this.$.table.scrollTop+=e.top-o)}if(!t.hasAttribute("detailscell")){var n=this.$.table.getBoundingClientRect().right,s=this.$.table.getBoundingClientRect().left,r=this._virtualFocus._focusedRow.querySelector("[last-frozen]");r&&(s=r.getBoundingClientRect().right),e.right>n?this.$.table.scrollLeft+=e.right-n:e.left<s&&(this.$.table.scrollLeft+=e.left-s)}}};</script>
</body></html>